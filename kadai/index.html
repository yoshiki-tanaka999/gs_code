<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>myMemoPad</title>
    <link rel="stylesheet" href="css/sample.css">
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
</head>

<body>

    <header>
        <h1>MemoPad</h1>
    </header>

    <!-- style="display: none;" -->
    <main>
        <input type = "text" id = "key">
        <textarea id="memo"></textarea>
        <ul>
            <li id="save">Save</li>
            <li id="clear">Clear</li>
        </ul>
    </main>
    <table id="list">

    </table>
    <footer><small>G's</small></footer>

    <script>
        // Save
        $("#save").on("click",function(){
            // 「value」という箱に、「#text_area」部分に書かれたこと(＝())を代入する(＝val())
            const key = $("#key").val();
            const value = $("#memo").val();

            console.log(key);
            console.log(value);
            // ローカルストレージにアイテム(= value)を取得する
            localStorage.setItem(key,value);
            alert("Saveしました");
            
            $("#list").append(
            '<tr id="click_item' + '">' +'<th>'+ key +'</th>' +
            '<td>' + '<input type="checkbox">' +
            '</td>' + '<td>' + value + '</td>' + '</tr>'
            );
        });

        // clearできるようにする
        $("#clear").on("click", function(){
            for(let i = 0; i < localStorage.length; i++) {
                let key = localStorage.key(i);
                // let value = localStorage.value(i);
            if($('#click_item' + key).prop("input[type='checkbox']:checked"))
            {
                localStorage.removeItem(key);
                // $("#list").empty();
            }
            }
            // window.location.reload();
            
            // localStorage.clear();
            alert("Clearしました");
            // テキスト欄を再度空欄にする処理？
            // val()= ()に何かを入れる
            // ""= 空欄
            // $("#list").empty();
        });

        // ページを読み込む
        // ローカルストレージに保存がされたとき、
        if(localStorage.getItem("#memo")){
            // 「value」という箱に、ローカルストレージに登録されたデータを代入する
            const value = localStorage.getItem("#memo");
            // テキストエリアに↑のデータを代入する
            $("#memo").val(value);
        }

        // 実習
        for(let i =0; i<localStorage.length; i++){
            // key(何番)でkey名を取得
            const key = localStorage.key(i);
            const value = localStorage.getItem(key);
            // 一覧表示
            $('#list').append(
            '<tr id="click_item' + '">' +'<th>'+ key +'</th>' +
            '<td>' + '<input type="checkbox">' +
            '</td>' + '<td>' + value + '</td>' + '</tr>'
        );
        }

        // 選択した行を削除する
        // 参考URL：https://teratail.com/questions/178055
        // for (var i = 0; i < localStorage.length; i++) {
        // const key = localStorage.key(i);
        // if (key !== 'data') localStorage.remove(key);
        // }
        // var data = localStorage.getItem("data");
        // localStorage.clear();
        // localStorage.setItem("data", data);



        // 【目的】表示される履歴を選択削除する(勿論ストレージ側も)
        // １．appendをクリックできるようにする↑でclass要素を付与した
        // 参考URL：https://blog.keisuke11.com/webdesign/click-event-after-append/
        // $(".click_item").on("click", function(){
        //     $("td.click_item").addClass("test");
        // })

        // // クリックするごとに
        // let countUpValue = 0;
        // for(let i = 0; i>0; i++ ) {

        // }
        // $("td.click_item[i]").on("click", function(){ // カウントアップする関数の定義 
        // countUpValue+=1;
        // console.log(countUpValue);
        // })

// カウンタの初期値を設定

        // カウンタに1を加算

        // let test = document.getElementsByClassName("test");
        // for(let i = test.length-1; i>=0; i--) {
        //     test[i].addEventListener("click", function(){
        //         this.classList.toggle('active');
        //     })
        // }
        // ２．奇数回のクリック＝クリック済み ↔ 偶数回のクリック＝クリックをリセット
        // ３．クリック済みのとき、選択した履歴を削除する




                //※こんなこともできる例
                //付箋機能
                // 動画や画像を保存できるか →ローカルには格納できない
                
    </script>



</body>

</html>